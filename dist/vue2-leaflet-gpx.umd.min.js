(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue2-leaflet"),require("leaflet"),require("vue")):"function"===typeof define&&define.amd?define(["vue2-leaflet",,"vue"],e):"object"===typeof exports?exports["vue2-leaflet-gpx"]=e(require("vue2-leaflet"),require("leaflet"),require("vue")):t["vue2-leaflet-gpx"]=e(t["vue2-leaflet"],t["L"],t["vue"])})("undefined"!==typeof self?self:this,function(t,e,n){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"0205":function(e,n){e.exports=t},"860c":function(t,n){t.exports=e},"8bbf":function(t,e){t.exports=n},a779:function(t,e,n){var i,o,r=r||n("860c"),a=15e3,s=1e3,_=60*s,l=60*_,u=24*l,p={startIconUrl:"pin-icon-start.png",endIconUrl:"pin-icon-end.png",shadowUrl:"pin-shadow.png",wptIconUrls:{"":"pin-icon-wpt.png"},iconSize:[33,50],shadowSize:[50,50],iconAnchor:[16,45],shadowAnchor:[16,47],clickable:!1},f={color:"blue"},h={parseElements:["track","route","waypoint"]};r.GPX=r.FeatureGroup.extend({initialize:function(t,e){e.max_point_interval=e.max_point_interval||a,e.marker_options=this._merge_objs(p,e.marker_options||{}),e.polyline_options=this._merge_objs(f,e.polyline_options||{}),e.gpx_options=this._merge_objs(h,e.gpx_options||{}),r.Util.setOptions(this,e),r.GPXTrackIcon=r.Icon.extend({options:e.marker_options}),this._gpx=t,this._layers={},this._init_info(),t&&this._parse(t,e,this.options.async)},get_duration_string:function(t,e){var n="";t>=u&&(n+=Math.floor(t/u)+"d ",t%=u),t>=l&&(n+=Math.floor(t/l)+":",t%=l);var i=Math.floor(t/_);t%=_,i<10&&(n+="0"),n+=i+"'";var o=Math.floor(t/s);return t%=s,o<10&&(n+="0"),n+=o,n+=!e&&t>0?"."+Math.round(1e3*Math.floor(t))/1e3:'"',n},get_duration_string_iso:function(t,e){var n=this.get_duration_string(t,e);return n.replace("'",":").replace('"',"")},to_miles:function(t){return t/1.60934},to_ft:function(t){return 3.28084*t},m_to_km:function(t){return t/1e3},m_to_mi:function(t){return t/1609.34},get_name:function(){return this._info.name},get_desc:function(){return this._info.desc},get_author:function(){return this._info.author},get_copyright:function(){return this._info.copyright},get_distance:function(){return this._info.length},get_distance_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))},get_start_time:function(){return this._info.duration.start},get_end_time:function(){return this._info.duration.end},get_moving_time:function(){return this._info.duration.moving},get_total_time:function(){return this._info.duration.total},get_moving_pace:function(){return this.get_moving_time()/this.m_to_km(this.get_distance())},get_moving_pace_imp:function(){return this.get_moving_time()/this.get_distance_imp()},get_moving_speed:function(){return this.m_to_km(this.get_distance())/(this.get_moving_time()/36e5)},get_moving_speed_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))/(this.get_moving_time()/36e5)},get_total_speed:function(){return this.m_to_km(this.get_distance())/(this.get_total_time()/36e5)},get_total_speed_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))/(this.get_total_time()/36e5)},get_elevation_gain:function(){return this._info.elevation.gain},get_elevation_loss:function(){return this._info.elevation.loss},get_elevation_gain_imp:function(){return this.to_ft(this.get_elevation_gain())},get_elevation_loss_imp:function(){return this.to_ft(this.get_elevation_loss())},get_elevation_data:function(){var t=this;return this._info.elevation._points.map(function(e){return t._prepare_data_point(e,t.m_to_km,null,function(t,e){return t.toFixed(2)+" km, "+e.toFixed(0)+" m"})})},get_elevation_data_imp:function(){var t=this;return this._info.elevation._points.map(function(e){return t._prepare_data_point(e,t.m_to_mi,t.to_ft,function(t,e){return t.toFixed(2)+" mi, "+e.toFixed(0)+" ft"})})},get_elevation_max:function(){return this._info.elevation.max},get_elevation_min:function(){return this._info.elevation.min},get_elevation_max_imp:function(){return this.to_ft(this.get_elevation_max())},get_elevation_min_imp:function(){return this.to_ft(this.get_elevation_min())},get_average_hr:function(){return this._info.hr.avg},get_average_temp:function(){return this._info.atemp.avg},get_average_cadence:function(){return this._info.cad.avg},get_heartrate_data:function(){var t=this;return this._info.hr._points.map(function(e){return t._prepare_data_point(e,t.m_to_km,null,function(t,e){return t.toFixed(2)+" km, "+e.toFixed(0)+" bpm"})})},get_heartrate_data_imp:function(){var t=this;return this._info.hr._points.map(function(e){return t._prepare_data_point(e,t.m_to_mi,null,function(t,e){return t.toFixed(2)+" mi, "+e.toFixed(0)+" bpm"})})},get_cadence_data:function(){var t=this;return this._info.cad._points.map(function(e){return t._prepare_data_point(e,t.m_to_km,null,function(t,e){return t.toFixed(2)+" km, "+e.toFixed(0)+" rpm"})})},get_temp_data:function(){var t=this;return this._info.atemp._points.map(function(e){return t._prepare_data_point(e,t.m_to_km,null,function(t,e){return t.toFixed(2)+" km, "+e.toFixed(0)+" degrees"})})},get_cadence_data_imp:function(){var t=this;return this._info.cad._points.map(function(e){return t._prepare_data_point(e,t.m_to_mi,null,function(t,e){return t.toFixed(2)+" mi, "+e.toFixed(0)+" rpm"})})},get_temp_data_imp:function(){var t=this;return this._info.atemp._points.map(function(e){return t._prepare_data_point(e,t.m_to_mi,null,function(t,e){return t.toFixed(2)+" mi, "+e.toFixed(0)+" degrees"})})},reload:function(){this._init_info(),this.clearLayers(),this._parse(this._gpx,this.options,this.options.async)},_merge_objs:function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n},_prepare_data_point:function(t,e,n,i){var o=[e&&e(t[0])||t[0],n&&n(t[1])||t[1]];return o.push(i&&i(o[0],o[1])||o[0]+": "+o[1]),o},_init_info:function(){this._info={name:null,length:0,elevation:{gain:0,loss:0,max:0,min:1/0,_points:[]},hr:{avg:0,_total:0,_points:[]},duration:{start:null,end:null,moving:0,total:0},atemp:{avg:0,_total:0,_points:[]},cad:{avg:0,_total:0,_points:[]}}},_load_xml:function(t,e,n,i){void 0==i&&(i=this.options.async),void 0==n&&(n=this.options);var o=new window.XMLHttpRequest;o.open("GET",t,i);try{o.overrideMimeType("text/xml")}catch(r){}o.onreadystatechange=function(){4==o.readyState&&200==o.status&&e(o.responseXML,n)},o.send(null)},_parse:function(t,e,n){var i=this,o=function(t,e){var n=i._parse_gpx_data(t,e);n&&(i.addLayer(n),i.fire("loaded"))};if("<"===t.substr(0,1)){var r=new DOMParser;n?setTimeout(function(){o(r.parseFromString(t,"text/xml"),e)}):o(r.parseFromString(t,"text/xml"),e)}else this._load_xml(t,o,e,n)},_parse_gpx_data:function(t,e){var n,i,o,a=[],s=[],_=e.gpx_options.parseElements;_.indexOf("route")>-1&&s.push(["rte","rtept"]),_.indexOf("track")>-1&&s.push(["trkseg","trkpt"]);var l=t.getElementsByTagName("name");l.length>0&&(this._info.name=l[0].textContent);var u=t.getElementsByTagName("desc");u.length>0&&(this._info.desc=u[0].textContent);var p=t.getElementsByTagName("author");p.length>0&&(this._info.author=p[0].textContent);var f=t.getElementsByTagName("copyright");for(f.length>0&&(this._info.copyright=f[0].textContent),n=0;n<s.length;n++)for(o=t.getElementsByTagName(s[n][0]),i=0;i<o.length;i++){var h=this._parse_trkseg(o[i],t,e,s[n][1]);if(0!==h.length){var c=new r.Polyline(h,e.polyline_options);if(this.fire("addline",{line:c}),a.push(c),e.marker_options.startIcon||e.marker_options.startIconUrl){var m=new r.Marker(h[0],{clickable:e.marker_options.clickable,icon:e.marker_options.startIcon||new r.GPXTrackIcon({iconUrl:e.marker_options.startIconUrl})});this.fire("addpoint",{point:m,point_type:"start"}),a.push(m)}(e.marker_options.endIcon||e.marker_options.endIconUrl)&&(m=new r.Marker(h[h.length-1],{clickable:e.marker_options.clickable,icon:e.marker_options.endIcon||new r.GPXTrackIcon({iconUrl:e.marker_options.endIconUrl})}),this.fire("addpoint",{point:m,point_type:"end"}),a.push(m))}}if(this._info.hr.avg=Math.round(this._info.hr._total/this._info.hr._points.length),this._info.cad.avg=Math.round(this._info.cad._total/this._info.cad._points.length),this._info.atemp.avg=Math.round(this._info.atemp._total/this._info.atemp._points.length),_.indexOf("waypoint")>-1)for(o=t.getElementsByTagName("wpt"),i=0;i<o.length;i++){var d=new r.LatLng(o[i].getAttribute("lat"),o[i].getAttribute("lon")),g=o[i].getElementsByTagName("name");l="";g.length>0&&(l=g[0].textContent);var v=o[i].getElementsByTagName("desc");u="";v.length>0&&(u=v[0].textContent);var x=o[i].getElementsByTagName("sym"),y="";x.length>0&&(y=x[0].textContent);var b,k=e.marker_options.wptIcons,w=e.marker_options.wptIconUrls;if(k&&k[y])b=k[y];else if(w&&w[y])b=new r.GPXTrackIcon({iconUrl:w[y]});else if(k&&k[""])b=k[""];else{if(!w||!w[""]){console.log('No icon or icon URL configured for symbol type "'+y+'", and no fallback configured; ignoring waypoint.');continue}b=new r.GPXTrackIcon({iconUrl:w[""]})}var M=new r.Marker(d,{clickable:!0,title:l,icon:b});M.bindPopup("<b>"+l+"</b>"+(u.length>0?"<br>"+u:"")).openPopup(),this.fire("addpoint",{point:M,point_type:"waypoint"}),a.push(M)}return a.length>1?new r.FeatureGroup(a):1==a.length?a[0]:void 0},_parse_trkseg:function(t,e,n,i){var o=t.getElementsByTagName(i);if(!o.length)return[];for(var a=[],s=null,_=0;_<o.length;_++){var l,u=new r.LatLng(o[_].getAttribute("lat"),o[_].getAttribute("lon"));if(u.meta={time:null,ele:null,hr:null,cad:null,atemp:null},l=o[_].getElementsByTagName("time"),l.length>0&&(u.meta.time=new Date(Date.parse(l[0].textContent))),l=o[_].getElementsByTagName("ele"),l.length>0&&(u.meta.ele=parseFloat(l[0].textContent)),l=o[_].getElementsByTagNameNS("*","hr"),l.length>0&&(u.meta.hr=parseInt(l[0].textContent),this._info.hr._points.push([this._info.length,u.meta.hr]),this._info.hr._total+=u.meta.hr),l=o[_].getElementsByTagNameNS("*","cad"),l.length>0&&(u.meta.cad=parseInt(l[0].textContent),this._info.cad._points.push([this._info.length,u.meta.cad]),this._info.cad._total+=u.meta.cad),l=o[_].getElementsByTagNameNS("*","atemp"),l.length>0&&(u.meta.atemp=parseInt(l[0].textContent),this._info.atemp._points.push([this._info.length,u.meta.atemp]),this._info.atemp._total+=u.meta.atemp),u.meta.ele>this._info.elevation.max&&(this._info.elevation.max=u.meta.ele),u.meta.ele<this._info.elevation.min&&(this._info.elevation.min=u.meta.ele),this._info.elevation._points.push([this._info.length,u.meta.ele]),this._info.duration.end=u.meta.time,null!=s){this._info.length+=this._dist3d(s,u);var p=u.meta.ele-s.meta.ele;p>0?this._info.elevation.gain+=p:this._info.elevation.loss+=Math.abs(p),p=Math.abs(u.meta.time-s.meta.time),this._info.duration.total+=p,p<n.max_point_interval&&(this._info.duration.moving+=p)}else this._info.duration.start=u.meta.time;s=u,a.push(u)}return a},_dist2d:function(t,e){var n=6371e3,i=this._deg2rad(e.lat-t.lat),o=this._deg2rad(e.lng-t.lng),r=Math.sin(i/2)*Math.sin(i/2)+Math.cos(this._deg2rad(t.lat))*Math.cos(this._deg2rad(e.lat))*Math.sin(o/2)*Math.sin(o/2),a=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),s=n*a;return s},_dist3d:function(t,e){var n=this._dist2d(t,e),i=Math.abs(e.meta.ele-t.meta.ele);return Math.sqrt(Math.pow(n,2)+Math.pow(i,2))},_deg2rad:function(t){return t*Math.PI/180}}),"object"===typeof t.exports?t.exports=r:(i=r,o="function"===typeof i?i.call(e,n,e,t):i,void 0===o||(t.exports=o))},fb15:function(t,e,n){"use strict";var i;(n.r(e),"undefined"!==typeof window)&&((i=window.document.currentScript)&&(i=i.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(n.p=i[1]));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{display:"none"}},[t.ready?t._t("default"):t._e()],2)},r=[],a=n("8bbf"),s=n.n(a),_=n("860c"),l=n.n(_),u=(n("a779"),n("0205")),p=s.a.extend({props:{gpxFile:{type:String},visible:{type:Boolean,default:!0}},data:function(){return{ready:!1,mapObject:null,parentContainer:null}},mounted:function(){this.mapObject=new l.a.GPX(this.$props.gpxFile,{async:!0}).on("loaded",this.gpxLoaded).on("addpoint",this.addpoint).on("addline",this.addline),l.a.DomEvent.on(this.mapObject,this.$listeners),this.ready=!0,this.parentContainer=Object(u["findRealParent"])(this.$parent),this.parentContainer.addLayer(this)},beforeDestroy:function(){this.parentContainer.removeLayer(this)},methods:{gpxLoaded:function(){this.$emit("gpx-loaded",this.mapObject)},addpoint:function(t){this.$emit("addpoint",t)},addline:function(t){this.$emit("addline",t)}}}),f=p,h=f;function c(t,e,n,i,o,r,a,s){var _,l="function"===typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),i&&(l.functional=!0),r&&(l._scopeId="data-v-"+r),a?(_=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},l._ssrRegister=_):o&&(_=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),_)if(l.functional){l._injectStyles=_;var u=l.render;l.render=function(t,e){return _.call(e),u(t,e)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,_):[_]}return{exports:t,options:l}}var m=c(h,o,r,!1,null,null,null);m.options.__file="LGpx.vue";var d=m.exports;e["default"]=d}})["default"]});
//# sourceMappingURL=vue2-leaflet-gpx.umd.min.js.map